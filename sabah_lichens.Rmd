---
title: 'How much taxonomic expertise is necessary for prioritising areas of lowland rainforest sites as habitats for lichens in northeast-Borneo?'
author: 'Rob Mrowicki'
date: '`r format(Sys.time(), "%d %B %Y")`'
output:
  pdf_document:
    fig_caption: yes
    fig_crop: yes
---

```{r setup, include = FALSE}
source('./scripts/00_setup.R')  # run setup script
```

```{r source_scripts, include = FALSE}
# run data scripts:
source('./scripts/01_import_tidy_and_manipulate_data.R')
source('./scripts/02_summarise_data.R')
source('./scripts/03_analyse_data.R')
source('./scripts/04_plotting.R')
```

## Field sites

Sampling was conducted at three sites within different areas of lowland forest in northeast Borneo, including two old growth reserve sites, (1) Danum Valley Conservation Area ('D') and (2) Maliau Conservation Area ('M'), and one selectively logged site, (3) the Stability of Altered Forest Ecosystems (SAFE) Project area ('S').

At each site, ...

The following functional traits were recorded for each tree: (1) girth, measured as ...; (2) bark type (S = smooth, C = scaly, R = ridged/rough, DR = dry ancient); and (3) the presence of buttresses or flutes.

Numbers of observations per site:

```{r nobs_tables, echo = FALSE}
# insert tables for numbers of observations vs. site:
# ~ lichen taxonomic groups:
kable(nobs_site_li_taxa, caption = 'Lichen taxonomic group data')
# ~ lichen functional groups:
kable(nobs_site_li_func, caption = 'Lichen functional group data')
# ~ tree functional traits:
kable(nobs_site_tr_func, caption = 'Tree functional trait data')
```

Are there missing observations? (See _Queries_ below.)

## Data analysis

Taxonomic/functional group richness (_S_) and Shannon-Wiener diversity (_H\'_) were calculated for each tree.

Tree bark type was coded numerically in relation to increasing roughness, i.e. smooth = 0, scaly = 1, ridged/rough = 2, ancient dry = 3. (See _Queries_ below.)

Analysis of variance (ANOVA) was used to test for differences in lichen taxonomic and functional group richness and diversity among the three sites. Tests were based on Type II Sums of Squares owing to unequal numbers of observations among groups.

Differences in multivariate lichen community structure among sites were tested using permutational multivariate analysis of variance (PERMANOVA), separately for taxonomic and functional groups. Analyses involved 9,999 permutations of residuals under a reduced model. (Normally, non-metric multidimensional scaling (MDS) plots would be used to visualise overall differences in community structure... however, MDS analyses failed to converge on a result.)

For all multivariate tests, community dissimilarities were calculated using the zero-adjusted Bray-Curtis coefficient (Clarke _et al._, 2006, _J. Exp. Mar. Biol. Ecol._ 330:55--80), based on $log10(x+1)$-transformed abundance data to reduce the influence of numerically dominant taxonomic/functional groups.

## Preliminary results

Mean lichen diversity (_H\'_ and _S_) per site:

```{r mean_div_tables, echo = FALSE}
# insert summary tables for mean lichen diversity vs. site:
# ~ taxonomic groups:
kable(mean_div_li_taxa, caption = 'Taxonomic group data')
# ~ functional groups:
kable(mean_div_li_func, caption = 'Functional group data')
```

![Boxplot of lichen taxonomic group richness (_S_) and diversity (_H\'_) versus site (D = Danum Valley Conservation Area, M = Maliau Conservation Area, S = Stability of Altered Forest Ecosystems (SAFE) Project area).](./figs/boxplots_taxa.pdf)

![Boxplot of lichen functional group richness and diversity versus site.](./figs/boxplots_func.pdf)

As expected, lichen richness and diversity (in terms of both taxonomic and functional groups) appeared to be lower at the disturbed site compared to the other two sites. While ANOVAs indicated significant differences in all cases, these results must be interpreted with caution owing to the poor fit of data to models -- specifically, assumptions of normality and/or homoscedasticity were contravened. (Perhaps because the data are zero-inflated, i.e. contain an excessively large number of empty observations? In this case, permutational ANOVA (PERANOVA) may be more suitable for univariate analyses.)

ANOVA results:

```{r anova_tables, echo = FALSE}
# insert ANOVA tables
# ~ taxonomic groups:
# ~~ richness:
kable(anova_li_taxa_s, caption = 'Lichen taxonomic group _S_ vs. site')
# ~~ diversity:
kable(anova_li_taxa_h, caption = 'Lichen taxonomic group _H\'_ vs. site')
# ~ functional groups:
# ~~ richness:
kable(anova_li_func_s, caption = 'Lichen functional group _S_ vs. site')
# ~~ diversity:
kable(anova_li_func_h, caption = 'Lichen functional group _H\'_ vs. site')
```

There were significant differences in overall lichen community structure (in terms of both taxonomic and functional groups) not only between old growth and logged sites, but also between Danum and Maliau Conservation Areas. (The particular taxonomic/functional groups making the greatest contributions to these differences may be examined in more detail via SIMPER analysis.)

PERMANOVA tables and post-hoc pairwise test results:

```{r permanova_tables, echo = FALSE}
# insert PERMANOVA tables and post-hoc pairwise test results:
# ~ taxonomic groups:
kable(
  perm_li_taxa,
  caption = 'Lichen community structure (taxonomic groups) vs. site'
)
kable(perm_li_taxa_ph, caption = 'Post-hoc pairwise tests')
# ~ functional groups:
kable(
  perm_li_func,
  caption = 'Lichen community structure (functional groups) vs. site'
)
kable(perm_li_func_ph, caption = 'Post-hoc pairwise tests')
```



## Queries

1. In both lichen abundance datasets, there are two _D810_ columns -- is this a mistake (should these be combined into a single column in each case)? OR should one of these be labelled _D710_, as this tree is not present in either dataset?

1. The _crsco_ taxfree code is duplicated in the lichen functional group abundance dataset -- should the abundance variables be summed for these two rows?

1. There are no data for tree _SA4_ in the lichen functional group abundance dataset (in addition to tree _D710_ -- see above).

1. Can 'bark type' be coded numerically (i.e. an ordinal categorical variable), e.g. smooth = 1, scaly = 2, ridged/rough = 3, dry ancient = 4? In this way, it could be used as an environmental variable in the CAP analysis.
